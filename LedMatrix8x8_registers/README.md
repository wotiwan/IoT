# Led Matrix 8x8_registers

## Видео демонстрация работы


## Описание схемы
### Подключение светодиодной матрицы
Опытным путём определены пины отвечающие за строки и столбцы на матрице. 
1. Управление строками подключено через цифровые пины 8-13, а также
аналоговые A0, A1. На каждый пин подключён резистор номиналом 1 кОм.
2. Управление столбцами подключено через цифровые пины 2-7, а также аналоговые A4, A5.

# Описание скрипта `LedMatrix8x8.py`
### Программа осуществляет работу с матрицей построчно, в один момент времени горит только одна строка. Благодаря быстрой смене светящихся строк для глаза изображение кажется целостным.
В данной реализации в отличие от прошлой версии есть два сменяющихся изображения с пероидом в ~1 секунду.
В программе не используется встроенная `digitalWrite()` и была написана функция `customWrite()` для работы напрямую с регистрами.
Функция на вход принимает регистр порта, номер пина и состояние которое необходимо установить.
Реализована функция `row_ignition()`, которая получает на вход номер строки и байт состояния каждого светодиода в этом ряду.
Функция сначала выставляет состояние для каждого светодиода в строке, а после включает подсветку самого ряда.
Функция `row_off()` отключает все светодиоды в во всех рядах, устанавливая все пины портов PORTC, PORTD, PORTB в 0.

Программа работает благодаря системным прерываниям вызываемым таймером `TCCR2B` с установленным прескейлером
В функцию `ISR` вписана функция `row_off()`, затем проверка кол-ва показанных кадров, для определения какую картинку показывать.
Переменная `frames_counter` прибавляется каждый раз когда была отрисована последняя строка изоюражения, как только накопится 1000 кадров - произойдёт смена
на вторую картинку, как только наберётся 2000 кадров - обратно на первую и счётчик сбросится.
Также есть счётчик `row_counter`, который отправляется в функцию `row_ignition()`. Как только он доходит до 7 - он сбрасывается обратно в 0.

# Рекомендации к применению
1. **Собрать светодиодную матрицу 8х8 в соответствие с распиновкой программы.**
2. **По желанию поменять картинкы выводящиеся на экран. Здесь 0 - светящийся светодиод, 1 - не светящийся**
3. **Запустить скрипт `LedMatrix8x8_registers.ino`**
